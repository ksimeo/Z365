<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns="http://www.springframework.org/schema/security"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-4.2.xsd">

    <!--
    Automatically registers a login form, BASIC authentication, anonymous authentication,
    logout services, remember-me and servlet-api-integration.
    -->
    <http auto-config="true" use-expressions="true">
        <form-login login-page="/login"
                    login-processing-url="/static/j_spring_security_check"
                    authentication-failure-url="/login"/>
        <logout logout-url="/static/j_spring_security_logout"/>
        <!--<intercept-url pattern="/admins/**" access="hasRole('ROLE_ADMIN') and hasRole('ROLE_USER')" />-->
        <!--<intercept-url pattern="/**" access="hasRole('ROLE_ADMIN') and hasRole('ROLE_USER')" />-->

        <!--<intercept-url pattern="/admins/**" requires-channel="https"/>-->
        <!--<remember-me key="spitterKey" token-validity-seconds="2419200" />-->
    </http>

    <!--&lt;!&ndash;<start id="authentication_manager"/>&ndash;&gt;-->
    <authentication-manager alias="authenticationManager">
        <authentication-provider>
            <user-service>
                <user name="nazarz@meta.ua" password="samarchuk"
                      authorities="ROLE_ADMIN"/>
                <user name="ksimeo@gmail.com" password="gorOD312"
                      authorities="ROLE_ADMIN"/>
                <user name="testuser" password="test"
                      authorities="ROLE_USER"/>
            </user-service>
        </authentication-provider>
        <!--<authentication-provider user-service-ref="userService" />-->
    </authentication-manager>

    <!--<user-service id="userService">-->
        <!--<user name="nazarz@meta.ua" password="samurchuk"-->
              <!--authorities="ROLE_ADMIN"/>-->
        <!--<user name="ksimeo@gmail.com" password="gorOD312"-->
              <!--authorities="ROLE_ADMIN"/>-->
        <!--<user name="testuser" password="test"-->
              <!--authorities="ROLE_USER"/>-->
    <!--</user-service>-->
    <!--<http auto-config="true" use-expressions="true">-->
        <!--<form-login login-page="/login"-->
                    <!--login-processing-url="/static/j_spring_security_check"-->
                    <!--authentication-failure-url="/login"/>-->
        <!--<logout logout-url="/static/j_spring_security_logout"/>-->
        <!--&lt;!&ndash;<intercept-url pattern="/favicon.ico" access="permitAll" />&ndash;&gt;-->
        <!--&lt;!&ndash;<intercept-url pattern="/home" access="hasRole('ROLE_SPITTER')"/>&ndash;&gt;-->
        <!--<intercept-url pattern="/admins/**"-->
                       <!--access="isAuthenticated() and principal.username=='habuma'"/>-->
        <!--<intercept-url pattern="/login" requires-channel="https"/>-->
        <!--<intercept-url pattern="/**" requires-channel="https"/>-->

        <!--<remember-me key="spitterKey"-->
                     <!--token-validity-seconds="2419200" />-->

        <!--<user-service id="userService">-->
            <!--<user name="habuma" password="letmein"-->
                  <!--authorities="ROLE_SPITTER,ROLE_ADMIN"/>-->
            <!--<user name="twoqubed" password="longhorns"-->
                  <!--authorities="ROLE_SPITTER"/>-->
            <!--<user name="admin" password="admin"-->
                  <!--authorities="ROLE_ADMIN"/>-->
        <!--</user-service>-->
    <!--</http>-->

    <!--<start id="globalMethodSecurity_securedAnnotations"/>-->
    <!--<global-method-security secured-annotations="enabled" />-->
    <!--<end id="globalMethodSecurity_securedAnnotations"/>-->
</beans:beans>